 ```
# Router Scan Results API

## Description

This API provides a list of the top vendors with the most CVEs. The data is collected from the router scan results database.

## Usage

To use this API, make a GET request to the following endpoint:

```
/api/reports/get_top_vendor_cve
```

The response will be a JSON object with the following format:

```
{
  "count": <number of vendors>,
  "data": [
    {
      "_id": <vendor name>,
      "cve": [
        {
          "cvss": <CVSS score>,
          "id": <CVE ID>,
          "port": <port number>,
          "severity": <severity level>
        },
        ...
      ],
      "cve_count": <number of CVEs>,
      "cve_critical": <number of critical CVEs>,
      "cve_high": <number of high CVEs>,
      "cve_medium": <number of medium CVEs>,
      "cve_low": <number of low CVEs>,
      "cve_none": <number of CVEs with no severity>,
      "vendor_count": <number of routers from this vendor>
    },
    ...
  ]
}
```

## Implementation

The API is implemented using the Flask microframework. The following code snippets show the key parts of the implementation:

```python
from config.get_db_connection import get_db_connection
from flask import jsonify

def get_top_vendor_cve():
    try:
        db = get_db_connection()
        collection = db["router_scan_results"]

        # Obtener los datos Ãºnicos de los proveedores (vendors)
        unique_vendors = collection.distinct("vendor")

        vendors_data = {}
        for vendor in unique_vendors:
            vendors_data[vendor] = []

        pipeline = [
            {
                "$group": {
                    "_id": "$ip",
                    "ip_count": {"$sum": 1},
                    "root": {"$first": "$$ROOT"},
                }
            },
            {"$unwind": "$root"},
            {
                "$group": {
                    "_id": "$root

Generated by [BlackboxAI](https://www.useblackbox.ai)